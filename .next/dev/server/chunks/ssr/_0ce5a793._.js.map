{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/sammargolis/OpenScribe/app/actions.ts"],"sourcesContent":["\"use server\"\n\nimport { generateText } from \"ai\"\nimport { createOpenAI } from \"@ai-sdk/openai\"\n\nexport async function transcribeAudio(audioBlob: Blob, apiKey: string | null): Promise<string> {\n  // For demo purposes, we'll simulate transcription\n  // In production, you would use Whisper API with the provided apiKey\n\n  // Simulate processing time\n  await new Promise((resolve) => setTimeout(resolve, 2000))\n\n  // For now, return a sample transcript\n  // In production: send audioBlob to Whisper API with apiKey\n  const sampleTranscript = `\nDoctor: Good morning, how are you feeling today?\n\nPatient: Not great, doctor. I've been having this persistent headache for about a week now.\n\nDoctor: I see. Can you describe the headache? Where is it located and how severe is it?\n\nPatient: It's mostly on the right side of my head, kind of behind my eye. I'd say it's about a 6 or 7 out of 10 on bad days.\n\nDoctor: Does anything make it better or worse?\n\nPatient: It gets worse when I'm looking at screens for too long. Resting in a dark room helps a bit.\n\nDoctor: Any other symptoms? Nausea, sensitivity to light, visual changes?\n\nPatient: Yeah, I've been a bit sensitive to bright lights. No nausea though.\n\nDoctor: Have you been under any unusual stress lately? Any changes in sleep patterns?\n\nPatient: Work has been pretty stressful. I've been sleeping maybe 5-6 hours a night instead of my usual 8.\n\nDoctor: Let me check your blood pressure and do a quick neurological exam.\n\n[Physical exam performed]\n\nDoctor: Your blood pressure is slightly elevated at 135/85. Neurological exam is normal. Based on your symptoms - the unilateral headache, photophobia, and association with stress and sleep deprivation - this appears to be a tension-type headache with some migraine features.\n\nPatient: Is that serious?\n\nDoctor: It's very manageable. I'd recommend starting with lifestyle modifications - prioritizing sleep, taking regular breaks from screens, and stress management. I'll also prescribe a mild pain reliever for acute episodes. If it doesn't improve in two weeks, we'll discuss preventive options.\n  `.trim()\n\n  return sampleTranscript\n}\n\nexport async function generateClinicalNote(params: {\n  transcript: string\n  patient_name: string\n  visit_reason: string\n  apiKey: string | null\n}): Promise<string> {\n  const { transcript, patient_name, visit_reason, apiKey } = params\n\n  const systemPrompt = `You are a clinical documentation assistant that converts patient encounter transcripts into structured clinical notes.\n\nIMPORTANT INSTRUCTIONS:\n- Output ONLY plain text in the exact format shown below\n- Do NOT use JSON, markdown code blocks, or any special formatting\n- Use ONLY information explicitly stated in the transcript\n- If a section has no relevant information, write \"Not discussed\"\n- Use professional medical terminology while keeping notes concise\n- This is a DRAFT that requires clinician review\n\nOUTPUT FORMAT (follow exactly):\n\nChief Complaint:\n[Primary reason for visit in 1-2 sentences]\n\nHPI:\n[History of present illness - onset, duration, character, severity, modifying factors]\n\nROS:\n[Review of systems - symptoms mentioned, organized by system]\n\nPhysical Exam:\n[Any exam findings mentioned, or \"Not documented\" if none]\n\nAssessment:\n[Clinical assessment/diagnosis mentioned by clinician]\n\nPlan:\n[Treatment plan discussed with patient]`\n\n  const userPrompt = `Convert this clinical encounter into a structured note.\n\nPatient Name: ${patient_name || \"Not provided\"}\nVisit Reason: ${visit_reason || \"Not provided\"}\n\nTRANSCRIPT:\n${transcript}\n\nGenerate the clinical note now, following the exact format specified.`\n\n  try {\n    if (apiKey) {\n      const openai = createOpenAI({ apiKey })\n      const { text } = await generateText({\n        model: openai(\"gpt-4o\"),\n        system: systemPrompt,\n        prompt: userPrompt,\n      })\n      return text\n    } else {\n      // Fallback to AI Gateway (no API key needed)\n      const { text } = await generateText({\n        model: \"openai/gpt-4o\",\n        system: systemPrompt,\n        prompt: userPrompt,\n      })\n      return text\n    }\n  } catch (error) {\n    console.error(\"AI generation error:\", error)\n    throw new Error(`Failed to generate note: ${error instanceof Error ? error.message : \"Unknown error\"}`)\n  }\n}\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;;;;;AAEO,eAAe,gBAAgB,SAAe,EAAE,MAAqB;IAC1E,kDAAkD;IAClD,oEAAoE;IAEpE,2BAA2B;IAC3B,MAAM,IAAI,QAAQ,CAAC,UAAY,WAAW,SAAS;IAEnD,sCAAsC;IACtC,2DAA2D;IAC3D,MAAM,mBAAmB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EA8B1B,CAAC,CAAC,IAAI;IAEN,OAAO;AACT;AAEO,eAAe,qBAAqB,MAK1C;IACC,MAAM,EAAE,UAAU,EAAE,YAAY,EAAE,YAAY,EAAE,MAAM,EAAE,GAAG;IAE3D,MAAM,eAAe,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;uCA4Be,CAAC;IAEtC,MAAM,aAAa,CAAC;;cAER,EAAE,gBAAgB,eAAe;cACjC,EAAE,gBAAgB,eAAe;;;AAG/C,EAAE,WAAW;;qEAEwD,CAAC;IAEpE,IAAI;QACF,IAAI,QAAQ;YACV,MAAM,SAAS,IAAA,+PAAY,EAAC;gBAAE;YAAO;YACrC,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,IAAA,0OAAY,EAAC;gBAClC,OAAO,OAAO;gBACd,QAAQ;gBACR,QAAQ;YACV;YACA,OAAO;QACT,OAAO;YACL,6CAA6C;YAC7C,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,IAAA,0OAAY,EAAC;gBAClC,OAAO;gBACP,QAAQ;gBACR,QAAQ;YACV;YACA,OAAO;QACT;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,wBAAwB;QACtC,MAAM,IAAI,MAAM,CAAC,yBAAyB,EAAE,iBAAiB,QAAQ,MAAM,OAAO,GAAG,iBAAiB;IACxG;AACF;;;IAlHsB;IA4CA;;AA5CA,sZAAA;AA4CA,sZAAA"}},
    {"offset": {"line": 133, "column": 0}, "map": {"version":3,"sources":["file:///Users/sammargolis/OpenScribe/.next-internal/server/app/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {transcribeAudio as '60131ca343eff8da86fa092aac608eadb8489c6878'} from 'ACTIONS_MODULE0'\nexport {generateClinicalNote as '40b2687437ea74cc4409f66ee4a755835b9c89eea3'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}}]
}